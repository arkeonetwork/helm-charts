---
apiVersion: v1
kind: ConfigMap
metadata: 
  name: {{ .Chart.Name }}
  namespace: {{ .Release.Name }}
data: 
  init.sh: |
    #!/bin/sh

    #initialize the relayer config file
      rly config init

    #add the chains to the config
      rly chains add --file /arkeo.json {{ .Values.chain1.name }}
      rly chains add {{ .Values.chain2.name }} --testnet

    #add new keys
      rly keys restore {{ .Values.chain1.name }} {{ .Values.chain1.keyname }} "{{ .Values.mnemonic.arkeo }}"
      rly keys restore {{ .Values.chain2.name }} {{ .Values.chain2.keyname }} "{{ .Values.mnemonic.osmo }}"

    #set keys as default 
      rly keys use {{ .Values.chain1.name }} {{ .Values.chain1.keyname }}
      rly keys use {{ .Values.chain2.name }} {{ .Values.chain2.keyname }}

    #query balance
      rly q balance {{ .Values.chain1.name }}
      rly q balance {{ .Values.chain2.name }}

    #create path
      rly paths new arkeo osmo-test-5 {{ .Values.pathname }}

    #create client, connection, channel
      rly tx link {{ .Values.pathname }} -d

    
  
  arkeo.json: |
    {
      "type": "cosmos",
      "value": {
        "key": "testkey",
        "chain-id": "arkeo",
        "rpc-addr": "http://arkeo.arkeo-testnet.svc.cluster.local:26657",
        "grpc-addr": "",
        "account-prefix": "tarkeo",
        "keyring-backend": "test",
        "gas-adjustment": 1.5,
        "gas-prices": "0.025uarkeo",
        "debug": true,
        "timeout": "10s",
        "output-format": "json",
        "sign-mode": "direct"
      }
    }
 
